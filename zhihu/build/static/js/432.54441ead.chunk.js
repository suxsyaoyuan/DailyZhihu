"use strict";(self.webpackChunkzhihu=self.webpackChunkzhihu||[]).push([[432],{3762:function(e,n,r){r.d(n,{Z:function(){return l}});var t=r(4165),a=r(5861),s=r(9439),o=r(1413),i=r(7313),c=r(4763),u=r(6417);function l(e){var n=(0,o.Z)({},e),r=n.children,l=n.onClick;delete n.children;var d=(0,i.useState)(!1),f=(0,s.Z)(d,2),p=f[0],m=f[1],h=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"===typeof l){e.next=2;break}return e.abrupt("return");case 2:return m(!0),e.prev=3,e.next=6,l();case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(3);case 10:m(!1);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(){return e.apply(this,arguments)}}();return l&&(n.onClick=h),(0,u.jsx)(c.zx,(0,o.Z)((0,o.Z)({},n),{},{loading:p,children:r}))}},631:function(e,n,r){var t,a=r(168),s=(r(7313),r(4763)),o=r(244),i=r(8467),c=r(2135),u=r(6417),l=o.ZP.div(t||(t=(0,a.Z)(["\n  .navbar-again-box {\n    padding: 0 0.26667rem;\n    height: 1.06667rem;\n    .adm-nav-bar-title {\n      font-size: 0.42667rem;\n    }\n    .adm-nav-bar-back-arrow {\n      font-size: 0.48rem;\n    }\n  }\n"]))),d=function(e){var n=e.title,r=(0,i.s0)(),t=(0,c.lr)()[0];return(0,u.jsx)(l,{children:(0,u.jsx)(s.l2,{className:"navbar-again-box",onBack:function(){var e=t.get("to"),n=t.get("lx");/^\/detail\//.test(e)?r(e,{replace:!0}):"/personal"!==e||"singout"!==n?r(-1):r("/",{replace:!0})},children:n})})};d.defaultProps={title:"\u4e2a\u4eba\u4e2d\u5fc3"},n.Z=d},5432:function(e,n,r){r.r(n);var t,a=r(4165),s=r(5861),o=r(9439),i=r(168),c=r(7313),u=r(4252),l=r(244),d=r(4763),f=r(631),p=r(3762),m=r(2321),h=r(508),v=r(6135),x=r(6928),Z=r(6417),b=l.ZP.div(t||(t=(0,i.Z)(["\n  .adm-form {\n    padding: 0.4rem;\n  }\n\n  .adm-input-element {\n    font-size: 0.37333rem;\n  }\n\n  .adm-form-footer {\n    .adm-button {\n      display: block;\n      margin: 0 auto;\n      width: 60%;\n      height: 0.93333rem;\n      font-size: 0.37333rem;\n      border-radius: 0;\n    }\n  }\n\n  .adm-form-item {\n    font-size: 0.37333rem;\n  }\n\n  .adm-list-item-content-extra {\n    .adm-button {\n      width: 2.66667rem;\n      font-size: 0.32rem;\n      border-radius: 0;\n    }\n  }\n"])));n.default=(0,v.$j)(null,x.Z.base)((function(e){var n=e.navigate,r=e.queryLoginInfo,t=e.query,i=d.l0.useForm(),l=(0,o.Z)(i,1)[0],v=(0,c.useState)(!1),x=(0,o.Z)(v,2),g=x[0],k=x[1],j=(0,c.useState)("\u53d1\u9001\u9a8c\u8bc1\u7801"),y=(0,o.Z)(j,2),z=y[0],w=y[1],I=(0,c.useState)(!1),C=(0,o.Z)(I,2),F=C[0],q=C[1],P=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(s){var o,i,c,d,f,p;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q(!0),e.prev=1,o=s.phone,i=s.code,e.next=5,m.Z.userLogin(o,i);case 5:if(c=e.sent,d=c.code,f=c.token,0!==+d){e.next=17;break}return h.Z.storage.set("TK",f),e.next=12,r();case 12:u.Z.success("\u767b\u5f55/\u6ce8\u518c\u6210\u529f"),(p=t.get("to"))?n(p,{replace:!0}):n("/"),e.next=19;break;case 17:u.Z.error("\u767b\u5f55/\u6ce8\u518c\u5931\u8d25"),l.setFieldValue("code","");case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1);case 24:q(!1);case 25:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(n){return e.apply(this,arguments)}}(),S=null,V=30,$=function(){if(k(!0),w("30s\u540e\u91cd\u53d1"),1===V)return clearInterval(S),S=null,k(!1),void w("\u53d1\u9001\u9a8c\u8bc1\u7801");V--,w("".concat(V,"s\u540e\u91cd\u53d1"))};(0,c.useEffect)((function(){return function(){S&&(clearInterval(S),S=null)}}),[]);var L=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var n,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.validateFields(["phone"]);case 3:return n=l.getFieldValue("phone"),e.next=6,m.Z.sendPhoneCode(n);case 6:if(r=e.sent,0!==+r.code){e.next=12;break}return u.Z.success("\u53d1\u9001\u6210\u529f"),S||(S=setInterval($,1e3)),e.abrupt("return");case 12:u.Z.error("\u53d1\u9001\u5931\u8d25"),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(0);case 17:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}();return(0,Z.jsxs)(b,{children:[(0,Z.jsx)(f.Z,{title:"\u767b\u5f55/\u6ce8\u518c"}),(0,Z.jsxs)(d.l0,{layout:"horizontal",style:{"--border-top":"none","--border-bottom":"none"},footer:(0,Z.jsx)(d.zx,{color:"primary",type:"submit",loading:F,children:"\u63d0\u4ea4"}),form:l,onFinish:P,initialValues:{phone:"",code:""},children:[(0,Z.jsx)(d.l0.Item,{name:"phone",label:"\u624b\u673a\u53f7",rules:[{required:!0,message:"\u624b\u673a\u53f7\u662f\u5fc5\u586b\u9879"},{pattern:/^(?:(?:\+|00)86)?1\d{10}$/,message:"\u624b\u673a\u53f7\u683c\u5f0f\u6709\u8bef"}],children:(0,Z.jsx)(d.II,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"})}),(0,Z.jsx)(d.l0.Item,{name:"code",label:"\u9a8c\u8bc1\u7801",rules:[{required:!0,message:"\u9a8c\u8bc1\u7801\u662f\u5fc5\u586b\u9879"},{pattern:/^\d{6}$/,message:"\u9a8c\u8bc1\u7801\u683c\u5f0f\u6709\u8bef"}],extra:(0,Z.jsx)(p.Z,{size:"small",color:"primary",disabled:g,onClick:L,children:z}),children:(0,Z.jsx)(d.II,{})})]})]})}))}}]);